/*!
 * Copyright(c) 2014. M2SOFT Co., Ltd. All source codes cannot be copied without permission.
 * 
 * @version: 6.4.5.572
 * @bulid date: 2017/12/27 06:46
 */
var m2soft=m2soft||{};m2soft.ns=function(e){var d=e.split("."),c=m2soft;if(d[0]==="m2soft"){d=d.slice(1)}for(var b=0,a=d.length;b<a;b++){if(typeof c[d[b]]==="undefined"){c[d[b]]={}}c=c[d[b]]}return c};m2soft.ns("m2soft.crownix.FormField.Sign");m2soft.crownix.FormField.Sign=function(m,b){var g;var t=$("#"+m);var d=b&&b.dpi?b.dpi:96,n=t.width(),l=t.height()?t.height():t.width()*0.4,u,p;var c=function(){u=(b&&b.width?b.width:n)*d/96,p=(b&&b.height?b.height:l)*d/96;l=t[0].style.height?t[0].style.height:n*p/u;g=document.createElement("canvas");g.width=u;g.height=p;var v=g.getContext("2d");v.strokeStyle="#000000";v.lineWidth=(b.width/u+1)*Math.pow(d/96,2);v.lineJoin="round";v.lineCap="round"};var j=function(D,A,E){var x=D;var v=x.getContext("2d");var C=g.getContext("2d");var B=A;var w=E;var y=false;var G={x:-1,y:-1,},F={x:-1,y:-1,},z={x:-1,y:-1};this.mousedown=function(H){H.preventDefault();G.x=H.originalEvent.pageX-B;G.y=H.originalEvent.pageY-w;y=true;v.beginPath();C.beginPath();v.moveTo(G.x,G.y);C.moveTo(g.width*G.x/v.canvas.width,g.height*G.y/v.canvas.height)};this.mousemove=function(H){if(y){H.preventDefault();F.x=H.originalEvent.pageX-B;F.y=H.originalEvent.pageY-w;z.x=(G.x+F.x)/2;z.y=(G.y+F.y)/2;if(G!=F){v.quadraticCurveTo(G.x,G.y,z.x,z.y);C.quadraticCurveTo(g.width*G.x/v.canvas.width,g.height*G.y/v.canvas.height,g.width*z.x/v.canvas.width,g.height*z.y/v.canvas.height);v.stroke();C.stroke();G.x=F.x;G.y=F.y}}};this.mouseup=function(H){if(y){H.preventDefault();v.closePath();y=false}};this.on=function(){var H=$("body");$(x).on("mousedown",this.mousedown);H.on("mousemove",this.mousemove);H.on("mouseup",this.mouseup)};this.off=function(){var H=$("body");$(x).off("mousedown",this.mousedown);H.off("mousemove",this.mousemove);H.off("mouseup",this.mouseup)}};var k=function(D,A,E){var x=D;var v=x.getContext("2d");var C=g.getContext("2d");var B=A;var w=E;var y=false;var G={x:-1,y:-1,},F={x:-1,y:-1,},z={x:-1,y:-1};this.touchstart=function(I){points=[];I.preventDefault();var H=I.touches[0];G.x=H.pageX-B;G.y=H.pageY-w;y=true;v.beginPath();C.beginPath();v.moveTo(G.x,G.y);C.moveTo(g.width*G.x/v.canvas.width,g.height*G.y/v.canvas.height)};this.touchmove=function(I){I.preventDefault();if(y){var H=I.touches[0];F.x=H.pageX-B;F.y=H.pageY-w;z.x=(G.x+F.x)/2;z.y=(G.y+F.y)/2;if(G!=F){v.quadraticCurveTo(G.x,G.y,z.x,z.y);C.quadraticCurveTo(g.width*G.x/v.canvas.width,g.height*G.y/v.canvas.height,g.width*z.x/v.canvas.width,g.height*z.y/v.canvas.height);v.stroke();C.stroke();G.x=F.x;G.y=F.y}}};this.touchend=function(H){H.preventDefault();if(y){v.closePath();y=false}};this.on=function(){x.addEventListener("touchstart",this.touchstart,false);x.addEventListener("touchmove",this.touchmove,false);x.addEventListener("touchend",this.touchend,false)}};var s=function(){g.getContext("2d").clearRect(0,0,u,p);a[0].getContext("2d").clearRect(0,0,n,l)};c();var a=$("<canvas>").css({position:"absolute",width:n,height:l,border:"1px solid",}).attr({width:n,height:l}).appendTo(t);var i=a[0].getContext("2d");i.strokeStyle="#000000";i.lineWidth=(n/u)*(d/96)+1;i.lineJoin="round";i.lineCap="round";var o=$("<div>").css({position:"relative","float":"right","font-weight":"bold",padding:"5px",cursor:"pointer"}).text("Reset").on("click",s).appendTo(t);var f=a.offset(),h=f.left,q=f.top;var e=new j(a[0],h,q);e.on();if("ontouchstart" in window&&!(/hp-tablet/gi).test(navigator.appVersion)){var r=new k(a[0],h,q);r.on()}this.getValue=function(){return g.toDataURL("image/png")}};